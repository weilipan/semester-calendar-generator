# 學期行事曆產生工具

這是一個 Google Apps Script (GAS) 專案，可在 Google Sheets 內自動產生學期行事曆，並整合臺灣假日日曆來標示假日。

## 功能特色
- **自動產生學期行事曆**：
  - 使用者輸入起始與結束日期（格式：YYYYMMDD）。
  - 自動生成對應的週次、月份、每日日期、課程目標、課程簡介與重要事項欄位。
- **整合臺灣假日行事曆**：
  - 透過 Google Calendar API 讀取臺灣假日日曆，並自動將假日標示於「重要事項」欄。
  - 假日日期的文字顏色會變紅，但不改變背景顏色。
- **格式美化**：
  - 標題列藍底白字、粗體、置中對齊。
  - 週次、月份等欄位適當調整大小。
  - 「課程目標」、「課程簡介」、「重要事項」等欄位自動換行並靠左對齊。
  - 六、日的文字為紅色，且交替底色區隔行數。
- **內建教師說明欄位**：
  - 於試算表最上方插入教師說明列，並合併儲存格，內容預設為「教師說明」。
  - 文字靠左靠上，自動換行，行高 200 像素。
- **整合至 Google Sheets 選單**：
  - 開啟試算表時，自動在選單中新增「學期行事曆」選項。
  - 可點擊「產生學期行事曆」來執行腳本。

## 安裝與使用方式
### 1. 設定 Google Sheets 指令碼編輯器
1. 打開 **Google Sheets**，點選「擴充功能」>「指令碼編輯器」。
2. 新增一個腳本檔案（Code.gs），並貼上 **Generate Semester Calendar** 的程式碼。
3. 點擊「執行」，並允許所需的權限。

### 2. 訂閱臺灣假日行事曆
> **⚠ 重要：請確保你的 Google Calendar 已訂閱臺灣假日行事曆！**

1. 前往 [Google Calendar](https://calendar.google.com/)。
2. 在左側「其他行事曆」部分，點擊 **「+ 新增行事曆」** > **「瀏覽有趣的行事曆」**。
3. 找到「臺灣假日」並點擊「訂閱」。
4. 確認 Google Calendar ID 為 `zh-tw.taiwan#holiday@group.v.calendar.google.com`。

### 3. 產生行事曆
1. 重新整理 Google Sheets。
2. 在試算表選單中，點擊 **「學期行事曆」** > **「產生學期行事曆」**。
3. 輸入 **起始日期與結束日期**（格式：YYYYMMDD，預設為當天日期）。
4. 按「確定」，系統將自動產生學期行事曆。

## 錯誤排除
- **沒有出現學期行事曆選單？**
  - 確保腳本已儲存，並重新整理試算表。
- **假日未正確顯示？**
  - 確保 Google Calendar 已訂閱「臺灣假日」行事曆。
  - 確保已允許 Google Apps Script 存取行事曆。
- **日期格式錯誤？**
  - 請使用 `YYYYMMDD` 格式，例如 `20250211`。
  - 確保起始日期早於或等於結束日期。

## 版權聲明
本專案採用 MIT License，歡迎自由使用與修改！

